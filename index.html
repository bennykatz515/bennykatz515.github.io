<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Car World Colosseum</title>
<!-- Keep your favicon setup from earlier -->
<link rel="icon" href="/favicon.png" />

<style>
  :root {
    --safe-padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0);
  }
  html, body { height: 100%; margin: 0; }
  body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, sans-serif;
    color: #fff;
    background: #000; /* fallback color while image loads */
    overscroll-behavior: none;
    touch-action: manipulation;
    user-select: none;
  }
  /* Responsive background using AVIF with WebP fallback */
  .bg {
    position: fixed; inset: 0; z-index: -1;
    background-position: center; background-repeat: no-repeat; background-size: cover;
    /* Mobile-first portrait (900x1600 provided). You can swap based on aspect. */
    /* Fallback first (works even if AVIF unsupported or image-set missing) */
    background-image: url('RedBackdrop.webp');
  }
  @supports (background-image: image-set(url('x.avif') type('image/avif'))) {
    .bg {
      background-image: image-set(
        url('RedBackdrop.avif') type('image/avif') 1x,
        url('RedBackdrop.webp') type('image/webp') 1x
      );
    }
  }

  /* Overlay to deter long-press/save and catch right-clicks */

  /* Layout */
  .wrap { min-height: 100%; display: grid; grid-template-rows: auto 1fr auto; padding: 16px; }
  header { display: grid; place-items: center; padding: 8px 0; }
  main { display: grid; place-items: center; }
  footer { display: grid; place-items: center; padding: 16px 0; }

  .logo { width: min(70vw, 520px); height: auto; pointer-events: none; -webkit-user-drag: none; }
  .stage { position: relative; width: min(92vw, 430px); aspect-ratio: 430/756; border-radius: 12px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,.6); }
  .cardArea { position: absolute; inset: 0; }
  .centerCard { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%) scaleX(1); width:min(70%, 340px); height:auto; image-rendering:auto; transition: transform 220ms ease-in; filter: drop-shadow(0 6px 16px rgba(0,0,0,.45)); }
  .centerCard.squish { transform:translate(-50%,-50%) scaleX(0.02); }

  /* CTA text example; you can replace with your styled image later */
  .cta { text-align: center; font-weight: 700; letter-spacing: .02em; text-shadow: 0 2px 8px rgba(0,0,0,.6); }
  .cta .small { opacity: .85; font-weight: 600; }

  /* Loading gate */

  /* Prevent image dragging/selection globally */
  img { -webkit-user-drag: none; user-drag: none; pointer-events: none; }
  [data-interactive] { pointer-events: auto; }
</style>

<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="wrap">
    <header>
      <img class="logo" src="logo.webp" alt="Car World Colosseum" width="900" height="522" />
    </header>

    <main>
      <div class="stage" id="stage" role="region" aria-label="Game stage">
        <div class="cardArea" id="cardArea"><img id="centerCard" class="centerCard" alt="Attendant" /></div>
      </div>
    </main>

    <footer>
      <div class="cta">
        <div class="small">JOIN THE WAITING LIST</div>
        <div>FOR A CHANCE TO WIN A GOLDEN ATTENDANT</div>
      </div>
    </footer>

    <div style="text-align:center; font-size:0.85rem; opacity:0.75; padding:8px 0;">
      Â© 2025 Car World Colosseum
    </div>
  </div>  </div>

<script>
  /* ------------------------------------------------------------
   * Minimal preloader (silent) + flip animation (body -> champion)
   * ---------------------------------------------------------- */
  const manifest = [
    'RedBackdrop.avif', 'RedBackdrop.webp', 'logo.webp',
    'body.avif', 'body.webp', 'champion.avif', 'champion.webp',
  ];

  function preload(url) {
    return new Promise((resolve) => {
      if (!/\.(avif|webp|png|jpg|jpeg|gif|svg)(\?.*)?$/i.test(url)) { resolve(); return; }
      const img = new Image();
      img.onload = img.onerror = () => resolve();
      img.src = url;
    });
  }

  (async function runPreload() {
    for (const url of manifest) { await preload(url); }
    // After preload, set initial image
    setSrc(centerCard, 'body');
  })();

  // Helper to set AVIF with WebP fallback
  function setSrc(img, base) {
    img.src = base + '.avif';
    img.onerror = () => { img.onerror = null; img.src = base + '.webp'; };
  }

  // Flip animation logic
  const stage = document.getElementById('stage');
  const centerCard = document.getElementById('centerCard');

  let flipped = false;
  let animating = false;

  stage.addEventListener('click', () => {
    if (animating || flipped) return;
    animating = true;
    centerCard.classList.add('squish');
  });

  centerCard.addEventListener('transitionend', (e) => {
    if (e.propertyName !== 'transform') return;
    // Midpoint: if we're squished, swap image and expand
    if (centerCard.classList.contains('squish')) {
      setSrc(centerCard, 'champion');
      // switch to ease-out for the return
      centerCard.style.transition = 'transform 260ms ease-out';
      centerCard.classList.remove('squish');
    } else {
      // Finished expanding
      flipped = true;
      animating = false;
    }
  });

  // Deter saving a bit: block context menu on key visuals
  document.addEventListener('contextmenu', (e) => {
    if (e.target.closest('.stage, .logo, .bg')) e.preventDefault();
  });
</script>
</body>
</html>
