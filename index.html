<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Car World Colosseum</title>
<!-- Keep your favicon setup from earlier -->
<link rel="icon" href="/favicon.png" />

<style>
  :root {
    --safe-padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0);
  }
  html, body { height: 100%; margin: 0; }
  body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, sans-serif;
    color: #fff;
    background: #000; /* fallback color while image loads */
    overscroll-behavior: none;
    touch-action: manipulation;
    user-select: none;
  }
  /* Responsive background using AVIF with WebP fallback */
  .bg {
    position: fixed; inset: 0; z-index: -1;
    background-position: center; background-repeat: no-repeat; background-size: cover;
    /* Mobile-first portrait (900x1600 provided). You can swap based on aspect. */
    background-image: image-set(
      url('/RedBackdrop.avif') type('image/avif') 1x,
      url('/RedBackdrop.webp') type('image/webp') 1x
    );
  }

  /* Overlay to deter long-press/save and catch right-clicks */
  .shield { position: fixed; inset: 0; z-index: 5; background: transparent; }

  /* Layout */
  .wrap { min-height: 100%; display: grid; grid-template-rows: auto 1fr auto; padding: 16px; }
  header { display: grid; place-items: center; padding: 8px 0; }
  main { display: grid; place-items: center; }
  footer { display: grid; place-items: center; padding: 16px 0; }

  .logo { width: min(70vw, 520px); height: auto; pointer-events: none; -webkit-user-drag: none; }
  .stage { position: relative; width: min(92vw, 430px); aspect-ratio: 430/756; border-radius: 12px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,.6); }
  .cardArea { position: absolute; inset: 0; }

  /* CTA text example; you can replace with your styled image later */
  .cta { text-align: center; font-weight: 700; letter-spacing: .02em; text-shadow: 0 2px 8px rgba(0,0,0,.6); }
  .cta .small { opacity: .85; font-weight: 600; }

  /* Loading gate */
  .gate { position: fixed; inset: 0; z-index: 10; display: grid; place-items: center; background: rgba(0,0,0,.82); backdrop-filter: blur(2px); }
  .gate .panel { background: rgba(20,20,20,.8); padding: 16px 20px; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,.6); text-align: center; }
  .btn { appearance: none; border: 0; padding: 10px 16px; border-radius: 10px; font-weight: 700; cursor: not-allowed; opacity: .6; }
  .btn.ready { cursor: pointer; opacity: 1; }

  /* Prevent image dragging/selection globally */
  img { -webkit-user-drag: none; user-drag: none; pointer-events: none; }
  [data-interactive] { pointer-events: auto; }
</style>

<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="shield" id="shield" aria-hidden="true"></div>

  <div class="wrap">
    <header>
      <img class="logo" src="/logo.webp" alt="Car World Colosseum" width="900" height="522" />
    </header>

    <main>
      <div class="stage" id="stage" role="region" aria-label="Game stage">
        <div class="cardArea" id="cardArea"></div>
      </div>
    </main>

    <footer>
      <div class="cta">
        <div class="small">JOIN THE WAITING LIST</div>
        <div>FOR A CHANCE TO WIN A GOLDEN ATTENDANT</div>
      </div>
    </footer>
  </div>

  <!-- Loading gate; enabled until all assets preload -->
  <div class="gate" id="gate">
    <div class="panel">
      <div id="progress">Loading… 0%</div>
      <button class="btn" id="startBtn" disabled>Start</button>
    </div>
  </div>

<script>
  /* ------------------------------------------------------------
   * Minimal preloader + interaction locks (no frameworks)
   * ---------------------------------------------------------- */
  const manifest = [
    // You can add more assets here as you produce them
    '/RedBackdrop.avif', '/RedBackdrop.webp', '/logo.webp',
    // '/attendant_body.avif', '/attendant_body.webp',
    // '/champion_body.avif', '/champion_body.webp',
    // '/arms/left_A.avif', '/arms/left_A.webp',
  ];

  const progressEl = document.getElementById('progress');
  const startBtn = document.getElementById('startBtn');
  const gate = document.getElementById('gate');
  const shield = document.getElementById('shield');
  const stage = document.getElementById('stage');

  // Deter saving: block context menu on visuals
  document.addEventListener('contextmenu', (e) => {
    if (e.target.closest('.stage, .logo, .bg')) e.preventDefault();
  });

  function preload(url) {
    return new Promise((resolve) => {
      const isImage = /\.(avif|webp|png|jpg|jpeg|gif|svg)(\?.*)?$/i.test(url);
      if (!isImage) { resolve(); return; }
      const img = new Image();
      img.onload = img.onerror = () => resolve();
      img.src = url;
    });
  }

  (async function runPreload() {
    let done = 0;
    for (const url of manifest) {
      await preload(url);
      done++;
      const pct = Math.round((done / manifest.length) * 100);
      progressEl.textContent = `Loading… ${pct}%`;
    }
    startBtn.disabled = false; startBtn.classList.add('ready'); startBtn.textContent = 'Start';
    startBtn.addEventListener('click', () => {
      gate.remove();
      // Allow interaction only after assets are ready
      shield.style.pointerEvents = 'none';
    }, { once: true });
  })();

  /* ------------------------------------------------------------
   * Placeholder interaction (click to toggle a temp image)
   * You can replace this with the real game logic later.
   * ---------------------------------------------------------- */
  const cardArea = document.getElementById('cardArea');
  let toggled = false;
  stage.addEventListener('click', () => {
    if (!document.body.contains(gate)) {
      toggled = !toggled;
      cardArea.innerHTML = '';
      if (toggled) {
        const temp = document.createElement('div');
        temp.style.position = 'absolute';
        temp.style.inset = '10%';
        temp.style.background = 'rgba(0,0,0,.35)';
        temp.style.border = '2px solid rgba(255,255,255,.6)';
        temp.style.borderRadius = '12px';
        cardArea.appendChild(temp);
      }
    }
  });
</script>
</body>
</html>
